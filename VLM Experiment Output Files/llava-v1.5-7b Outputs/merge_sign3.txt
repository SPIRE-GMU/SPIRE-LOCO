V4L2_DEVICES:  --device /dev/video0  --device /dev/video1 
### DISPLAY environmental variable is already set: ":1"
localuser:root being added to access control list
/usr/local/lib/python3.10/dist-packages/transformers/utils/hub.py:124: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Fetching 11 files:   0% 0/11 [00:00<?, ?it/s]Fetching 11 files: 100% 11/11 [00:00<00:00, 38705.83it/s]
16:07:25 | INFO | loading /data/models/huggingface/models--liuhaotian--llava-v1.5-7b/snapshots/4481d270cc22fd5c4d1bb5df129622006ccd9234 with MLC
16:07:29 | INFO | NumExpr defaulting to 12 threads.
[33m16:07:29 | WARNING | AWQ not installed (requires JetPack 6 / L4T R36) - AWQ models will fail to initialize[0m
16:07:30 | INFO | patching model config with {'model_type': 'llama'}
16:07:32 | INFO | device=cuda(0), name=Orin, compute=8.7, max_clocks=1300000, multiprocessors=16, max_thread_dims=[1024, 1024, 64], api_version=12060, driver_version=None
16:07:32 | INFO | loading llava-v1.5-7b from /data/models/mlc/dist/llava-v1.5-7b/ctx256/llava-v1.5-7b-q4f16_ft/llava-v1.5-7b-q4f16_ft-cuda.so
[33m16:07:32 | WARNING | model library /data/models/mlc/dist/llava-v1.5-7b/ctx256/llava-v1.5-7b-q4f16_ft/llava-v1.5-7b-q4f16_ft-cuda.so was missing metadata[0m
16:07:34 | INFO | loading clip vision model openai/clip-vit-large-patch14-336
/usr/local/lib/python3.10/dist-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
16:07:36 | INFO | loading TensorRT model from /root/.cache/clip_trt/openai-clip-vit-large-patch14-336_trt-1040_sm87_vision_projector.pt
/opt/clip_trt/clip_trt/vision.py:154: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  trt_model.load_state_dict(torch.load(trt_path))
[12/31/2024-16:07:42] [TRT] [W] Using an engine plan file across different models of devices is not recommended and is likely to affect performance or even cause errors.
16:07:42 | INFO | benchmarking clip vision model openai/clip-vit-large-patch14-336
16:07:44 | INFO | torch time:  376.56162133331844 ms
[12/31/2024-16:07:44] [TRT] [W] Using default stream in enqueueV3() may lead to performance issues due to additional calls to cudaStreamSynchronize() by TensorRT to ensure correct synchronization. Please use non-default stream instead.
16:07:44 | INFO | trt time:    40.84013866664312 ms
16:07:45 | INFO | y^ delta:    0.009745001792907715
16:07:45 | INFO | loaded clip vision model openai/clip-vit-large-patch14-336
/opt/NanoLLM/nano_llm/vision/mm_projector.py:146: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(filename, map_location='cpu')
16:07:45 | INFO | mm_projector (mlp2x_gelu)  Sequential(
  (0): Linear(in_features=1024, out_features=4096, bias=True)
  (1): GELU(approximate='none')
  (2): Linear(in_features=4096, out_features=4096, bias=True)
)
16:07:45 | INFO | mm_projector weights:  dict_keys(['0.bias', '0.weight', '2.bias', '2.weight'])
[32m┌────────────────────────────┬─────────────────────────────────────────────────────────────────────────────┐
│ _name_or_path              │ llava-v1.5-7b                                                               │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ architectures              │ ['LlavaLlamaForCausalLM']                                                   │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ bos_token_id               │ 1                                                                           │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ eos_token_id               │ 2                                                                           │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ freeze_mm_mlp_adapter      │ False                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ freeze_mm_vision_resampler │ False                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ hidden_act                 │ silu                                                                        │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ hidden_size                │ 4096                                                                        │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ image_aspect_ratio         │ pad                                                                         │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ initializer_range          │ 0.02                                                                        │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ intermediate_size          │ 11008                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ max_length                 │ 256                                                                         │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ max_position_embeddings    │ 4096                                                                        │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ mm_hidden_size             │ 1024                                                                        │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ mm_projector_type          │ mlp2x_gelu                                                                  │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ mm_resampler_type          │                                                                             │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ mm_use_im_patch_token      │ False                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ mm_use_im_start_end        │ False                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ mm_vision_select_feature   │ patch                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ mm_vision_select_layer     │ -2                                                                          │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ mm_vision_tower            │ openai/clip-vit-large-patch14-336                                           │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ model_type                 │ llama                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ num_attention_heads        │ 32                                                                          │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ num_hidden_layers          │ 32                                                                          │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ num_key_value_heads        │ 32                                                                          │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ pad_token_id               │ 0                                                                           │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ pretraining_tp             │ 1                                                                           │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ rms_norm_eps               │ 1e-05                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ rope_scaling               │                                                                             │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ tie_word_embeddings        │ False                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ torch_dtype                │ float16                                                                     │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ transformers_version       │ 4.31.0                                                                      │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ tune_mm_mlp_adapter        │ False                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ tune_mm_vision_resampler   │ False                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ unfreeze_mm_vision_tower   │ False                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ use_cache                  │ True                                                                        │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ use_mm_proj                │ True                                                                        │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ vocab_size                 │ 32000                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ name                       │ llava-v1.5-7b                                                               │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ api                        │ mlc                                                                         │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ mm_projector_path          │ /data/models/huggingface/models--liuhaotian--llava-v1.5-7b/snapshots/4481d2 │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ quant                      │ q4f16_ft                                                                    │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ type                       │ llama                                                                       │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ prefill_chunk_size         │ -1                                                                          │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ load_time                  │ 19.748408191999943                                                          │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ params_size                │ 3232.7265625                                                                │
└────────────────────────────┴─────────────────────────────────────────────────────────────────────────────┘[0m

16:07:45 | INFO | using chat template 'llava-v1' for model llava-v1.5-7b
16:07:45 | INFO | model 'llava-v1.5-7b', chat template 'llava-v1' stop tokens:  ['</s>'] -> [2]
16:07:45 | INFO | Warming up LLM with query 'What is 2+2?'
16:07:46 | INFO | Warmup response:  '2+2 is equal to 4.</s>'
16:07:46 | INFO | plugin | connected PrintStream to on_text on channel 0
16:07:46 | INFO | plugin | connected ChatQuery to PrintStream on channel 0
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

(gst-plugin-scanner:102): GLib-GObject-[1;33mWARNING[0m **: [34m16:07:47.577[0m: cannot register existing type 'GstRtpSrc'

(gst-plugin-scanner:102): GLib-GObject-[1;35mCRITICAL[0m **: [34m16:07:47.577[0m: g_type_add_interface_static: assertion 'G_TYPE_IS_INSTANTIATABLE (instance_type)' failed

(gst-plugin-scanner:102): GLib-[1;35mCRITICAL[0m **: [34m16:07:47.577[0m: g_once_init_leave: assertion 'result != 0' failed

(gst-plugin-scanner:102): GStreamer-[1;35mCRITICAL[0m **: [34m16:07:47.577[0m: gst_element_register: assertion 'g_type_is_a (type, GST_TYPE_ELEMENT)' failed

(gst-plugin-scanner:102): GLib-GObject-[1;33mWARNING[0m **: [34m16:07:47.577[0m: cannot register existing type 'GstRtpSink'

(gst-plugin-scanner:102): GLib-GObject-[1;35mCRITICAL[0m **: [34m16:07:47.577[0m: g_type_add_interface_static: assertion 'G_TYPE_IS_INSTANTIATABLE (instance_type)' failed

(gst-plugin-scanner:102): GLib-[1;35mCRITICAL[0m **: [34m16:07:47.578[0m: g_once_init_leave: assertion 'result != 0' failed

(gst-plugin-scanner:102): GStreamer-[1;35mCRITICAL[0m **: [34m16:07:47.578[0m: gst_element_register: assertion 'g_type_is_a (type, GST_TYPE_ELEMENT)' failed
sh: 1: lsmod: not found
sh: 1: modprobe: not found
[gstreamer] initialized gstreamer, version 1.20.3.0
[gstreamer] gstCamera -- attempting to create device v4l2:///dev/video0
[gstreamer] gstCamera -- found v4l2 device: C270 HD WEBCAM
[gstreamer] v4l2-proplist, device.path=(string)/dev/video0, udev-probed=(boolean)false, device.api=(string)v4l2, v4l2.device.driver=(string)uvcvideo, v4l2.device.card=(string)"C270\ HD\ WEBCAM", v4l2.device.bus_info=(string)usb-3610000.usb-4.4, v4l2.device.version=(uint)331668, v4l2.device.capabilities=(uint)2225078273, v4l2.device.device_caps=(uint)69206017;
[gstreamer] gstCamera -- found 36 caps for v4l2 device /dev/video0
[gstreamer] [0] video/x-raw, format=(string)YUY2, width=(int)1280, height=(int)720, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 10/1, 15/2, 5/1 };
[gstreamer] [1] video/x-raw, format=(string)YUY2, width=(int)1184, height=(int)656, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 10/1, 15/2, 5/1 };
[gstreamer] [2] video/x-raw, format=(string)YUY2, width=(int)960, height=(int)720, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 10/1, 15/2, 5/1 };
[gstreamer] [3] video/x-raw, format=(string)YUY2, width=(int)1024, height=(int)576, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 10/1, 15/2, 5/1 };
[gstreamer] [4] video/x-raw, format=(string)YUY2, width=(int)960, height=(int)544, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [5] video/x-raw, format=(string)YUY2, width=(int)800, height=(int)600, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [6] video/x-raw, format=(string)YUY2, width=(int)864, height=(int)480, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [7] video/x-raw, format=(string)YUY2, width=(int)800, height=(int)448, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [8] video/x-raw, format=(string)YUY2, width=(int)752, height=(int)416, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [9] video/x-raw, format=(string)YUY2, width=(int)640, height=(int)480, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [10] video/x-raw, format=(string)YUY2, width=(int)640, height=(int)360, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [11] video/x-raw, format=(string)YUY2, width=(int)544, height=(int)288, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [12] video/x-raw, format=(string)YUY2, width=(int)432, height=(int)240, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [13] video/x-raw, format=(string)YUY2, width=(int)352, height=(int)288, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [14] video/x-raw, format=(string)YUY2, width=(int)320, height=(int)240, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [15] video/x-raw, format=(string)YUY2, width=(int)320, height=(int)176, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [16] video/x-raw, format=(string)YUY2, width=(int)176, height=(int)144, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [17] video/x-raw, format=(string)YUY2, width=(int)160, height=(int)120, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [18] image/jpeg, width=(int)1280, height=(int)720, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [19] image/jpeg, width=(int)1184, height=(int)656, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [20] image/jpeg, width=(int)960, height=(int)720, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [21] image/jpeg, width=(int)1024, height=(int)576, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [22] image/jpeg, width=(int)960, height=(int)544, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [23] image/jpeg, width=(int)800, height=(int)600, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [24] image/jpeg, width=(int)864, height=(int)480, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [25] image/jpeg, width=(int)800, height=(int)448, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [26] image/jpeg, width=(int)752, height=(int)416, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [27] image/jpeg, width=(int)640, height=(int)480, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [28] image/jpeg, width=(int)640, height=(int)360, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [29] image/jpeg, width=(int)544, height=(int)288, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [30] image/jpeg, width=(int)432, height=(int)240, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [31] image/jpeg, width=(int)352, height=(int)288, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [32] image/jpeg, width=(int)320, height=(int)240, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [33] image/jpeg, width=(int)320, height=(int)176, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [34] image/jpeg, width=(int)176, height=(int)144, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] [35] image/jpeg, width=(int)160, height=(int)120, pixel-aspect-ratio=(fraction)1/1, framerate=(fraction){ 30/1, 24/1, 20/1, 15/1, 10/1, 15/2, 5/1 };
[gstreamer] gstCamera -- selected device profile:  codec=MJPEG format=unknown width=1280 height=720 framerate=30
[gstreamer] gstCamera pipeline string:
[gstreamer] v4l2src device=/dev/video0 do-timestamp=true ! image/jpeg, width=(int)1280, height=(int)720, framerate=30/1 ! jpegdec name=decoder ! video/x-raw ! appsink name=mysink sync=false
[gstreamer] gstCamera successfully created device v4l2:///dev/video0
[0;32m[video]  created gstCamera from v4l2:///dev/video0
[0m------------------------------------------------
gstCamera video options:
------------------------------------------------
  -- URI: v4l2:///dev/video0
     - protocol:  v4l2
     - location:  /dev/video0
  -- deviceType: v4l2
  -- ioType:     input
  -- codec:      MJPEG
  -- codecType:  cpu
  -- width:      1280
  -- height:     720
  -- frameRate:  30
  -- numBuffers: 4
  -- zeroCopy:   true
  -- flipMethod: none
  -- sslCert     /etc/ssl/private/localhost.cert.pem
  -- sslKey      /etc/ssl/private/localhost.key.pem
------------------------------------------------
[OpenGL] glDisplay -- X screen 0 resolution:  1920x1080
[OpenGL] glDisplay -- X window resolution:    1920x1080
[OpenGL] glDisplay -- display device initialized (1920x1080)
[0;32m[video]  created glDisplay from display://0
[0m------------------------------------------------
glDisplay video options:
------------------------------------------------
  -- URI: display://0
     - protocol:  display
     - location:  0
  -- deviceType: display
  -- ioType:     output
  -- width:      1920
  -- height:     1080
  -- frameRate:  0
  -- numBuffers: 4
  -- zeroCopy:   true
  -- sslCert     /etc/ssl/private/localhost.cert.pem
  -- sslKey      /etc/ssl/private/localhost.key.pem
------------------------------------------------
16:07:49 | INFO | plugin | connected VideoSource to on_video on channel 0
16:07:49 | INFO | mounting webserver path /data/datasets/uploads to /images/uploads
[gstreamer] opening gstCamera for streaming, transitioning pipeline to GST_STATE_PLAYING
[gstreamer] gstreamer changed state from NULL to READY ==> mysink
[gstreamer] gstreamer changed state from NULL to READY ==> capsfilter1
[gstreamer] gstreamer changed state from NULL to READY ==> decoder
[gstreamer] gstreamer changed state from NULL to READY ==> capsfilter0
[gstreamer] gstreamer changed state from NULL to READY ==> v4l2src0
[gstreamer] gstreamer changed state from NULL to READY ==> pipeline0
[gstreamer] gstreamer changed state from READY to PAUSED ==> capsfilter1
[gstreamer] gstreamer changed state from READY to PAUSED ==> decoder
[gstreamer] gstreamer changed state from READY to PAUSED ==> capsfilter0
[gstreamer] gstreamer stream status CREATE ==> src
[gstreamer] gstreamer changed state from READY to PAUSED ==> v4l2src0
[gstreamer] gstreamer changed state from READY to PAUSED ==> pipeline0
[gstreamer] gstreamer message new-clock ==> pipeline0
[gstreamer] gstreamer changed state from PAUSED to PLAYING ==> capsfilter1
[gstreamer] gstreamer changed state from PAUSED to PLAYING ==> decoder
[gstreamer] gstreamer changed state from PAUSED to PLAYING ==> capsfilter0
[gstreamer] gstreamer changed state from PAUSED to PLAYING ==> v4l2src0
16:07:49 | INFO | starting webserver @ https://0.0.0.0:8050
[32m16:07:49 | SUCCESS | VideoQuery - system ready[0m
 * Serving Flask app 'nano_llm.web.server'
 * Debug mode: on
16:07:49 | INFO | [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on https://127.0.0.1:8050
 * Running on https://10.166.153.27:8050
16:07:49 | INFO | [33mPress CTRL+C to quit[0m
[gstreamer] gstreamer stream status ENTER ==> src
[gstreamer] gstreamer message stream-start ==> pipeline0
[gstreamer] gstCamera -- onPreroll
[0;33m[gstreamer] gstBufferManager -- map buffer size was less than max size (1382400 vs 1382407)
[0m[gstreamer] gstBufferManager recieve caps:  video/x-raw, format=(string)I420, width=(int)1280, height=(int)720, interlace-mode=(string)progressive, multiview-mode=(string)mono, multiview-flags=(GstVideoMultiviewFlagsSet)0:ffffffff:/right-view-first/left-flipped/left-flopped/right-flipped/right-flopped/half-aspect/mixed-mono, pixel-aspect-ratio=(fraction)1/1, chroma-site=(string)jpeg, colorimetry=(string)1:4:0:0, framerate=(fraction)30/1
[gstreamer] gstBufferManager -- recieved first frame, codec=MJPEG format=i420 width=1280 height=720 size=1382407
[cuda]   allocated 4 ring buffers (1382407 bytes each, 5529628 bytes total)
[cuda]   allocated 4 ring buffers (8 bytes each, 32 bytes total)
[gstreamer] gstreamer changed state from READY to PAUSED ==> mysink
[gstreamer] gstreamer message async-done ==> pipeline0
[gstreamer] gstreamer message latency ==> mysink
[gstreamer] gstreamer changed state from PAUSED to PLAYING ==> mysink
[gstreamer] gstreamer changed state from PAUSED to PLAYING ==> pipeline0
[cuda]   allocated 4 ring buffers (2764800 bytes each, 11059200 bytes total)
[OpenGL] glDisplay -- set the window size to 1280x720
[OpenGL] creating 1280x720 texture (GL_RGB8 format, 2764800 bytes)
[cuda]   registered openGL texture for interop access (1280x720, GL_RGB8, 2764800 bytes)
[32m
[0m[32m
[0m[32mIn[0m[32m the[0m[32m image[0m[32m,[0m[32m there[0m[32m is[0m[32m a[0m[32m sign[0m[32m that[0m[32m says[0m[32m "[0m[32mD[0m[32mrive[0m[32m carefully[0m[32m."[0m[32m This[0m[32m sign[0m[32m is[0m[32m likely[0m[32m to[0m[32m be[0m[32m displayed[0m[32m in[0m[32m a[0m[32m location[0m[32m where[0m[32m drivers[0m[32m need[0m[32m to[0m[32m be[0m[32m c[0m[32maut[0m[32mious[0m[32m,[0m[32m such[0m[32m as[0m[32m near[0m[32m a[0m[32m school[0m[32m,[0m[32m a[0m[32m park[0m[32m,[0m[32m or[0m[32m a[0m[32m resident[0m[32mial[0m[32m area[0m[32m.[0m[32m The[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m is[0m[32m [0m[32m1[0m[32m0[0m[32m0[0m[32m%,[0m
[32m
[0m[32m
[0m[32mIn[0m[32m the[0m[32m image[0m[32m,[0m[32m there[0m[32m is[0m[32m a[0m[32m sign[0m[32m that[0m[32m says[0m[32m "[0m[32mD[0m[32mrive[0m[32m Care[0m[32mfully[0m[32m."[0m[32m This[0m[32m suggests[0m[32m that[0m[32m the[0m[32m driver[0m[32m should[0m[32m be[0m[32m c[0m[32maut[0m[32mious[0m[32m while[0m[32m driving[0m[32m.[0m[32m The[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m is[0m[32m [0m[32m1[0m[32m0[0m[32m0[0m[32m,[0m[32m as[0m[32m the[0m[32m sign[0m[32m is[0m[32m clearly[0m[32m visible[0m[32m and[0m[32m con[0m[32mve[0m[32mys[0m[32m a[0m[32m strong[0m[32m message[0m[32m to[0m[32m the[0m[32m driver[0m[32m.[0m[32m[0m
16:07:58 | INFO | refresh rate:  0.25 FPS (3986.4 ms)
[32m
[0m[32m
[0m[32mIn[0m[32m the[0m[32m image[0m[32m,[0m[32m there[0m[32m is[0m[32m a[0m[32m sign[0m[32m that[0m[32m says[0m[32m "[0m[32mD[0m[32mrive[0m[32m Care[0m[32mfully[0m[32m."[0m[32m This[0m[32m suggests[0m[32m that[0m[32m the[0m[32m driver[0m[32m should[0m[32m be[0m[32m c[0m[32maut[0m[32mious[0m[32m while[0m[32m driving[0m[32m.[0m[32m The[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m is[0m[32m [0m[32m1[0m[32m0[0m[32m0[0m[32m,[0m[32m as[0m[32m the[0m[32m sign[0m[32m is[0m[32m clearly[0m[32m visible[0m[32m and[0m[32m con[0m[32mve[0m[32mys[0m[32m a[0m[32m strong[0m[32m message[0m[32m to[0m[32m the[0m[32m driver[0m[32m.[0m[32m[0m
16:08:01 | INFO | refresh rate:  0.28 FPS (3596.5 ms)
[32m1[0m[32m0[0m[32m0[0m[32m%[0m[32m
[0m[32m
[0m[32mIn[0m[32m the[0m[32m image[0m[32m,[0m[32m there[0m[32m is[0m[32m a[0m[32m sign[0m[32m that[0m[32m says[0m[32m "[0m[32mD[0m[32mrive[0m[32m Care[0m[32mfully[0m[32m."[0m[32m This[0m[32m suggests[0m[32m that[0m[32m the[0m[32m driver[0m[32m should[0m[32m be[0m[32m c[0m[32maut[0m[32mious[0m[32m while[0m[32m driving[0m[32m.[0m[32m The[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m is[0m[32m [0m[32m1[0m[32m0[0m[32m0[0m[32m%,[0m[32m as[0m[32m the[0m[32m sign[0m[32m clearly[0m[32m con[0m[32mve[0m[32mys[0m[32m the[0m[32m importance[0m[32m of[0m[32m safe[0m[32m driving[0m[32m.[0m[32m[0m
16:08:05 | INFO | refresh rate:  0.28 FPS (3621.2 ms)
[32m1[0m[32m0[0m[32m0[0m[32m%[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m.[0m[32m The[0m[32m image[0m[32m features[0m[32m a[0m[32m sign[0m[32m that[0m[32m says[0m[32m "[0m[32mD[0m[32mrive[0m[32m Care[0m[32mfully[0m[32m."[0m[32m This[0m[32m suggests[0m[32m that[0m[32m the[0m[32m driver[0m[32m should[0m[32m be[0m[32m c[0m[32maut[0m[32mious[0m[32m while[0m[32m driving[0m[32m.[0m[32m The[0m[32m sign[0m[32m is[0m[32m a[0m[32m clear[0m[32m indic[0m[32mation[0m[32m for[0m[32m the[0m[32m driver[0m[32m to[0m[32m be[0m[32m more[0m[32m att[0m[32ment[0m[32mive[0m[32m and[0m[32m responsible[0m[32m while[0m[32m on[0m[32m the[0m[32m road[0m[32m.[0m[32m[0m
16:08:09 | INFO | refresh rate:  0.29 FPS (3473.2 ms)
[32m1[0m[32m0[0m[32m0[0m[32m%[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m.[0m[32m The[0m[32m image[0m[32m features[0m[32m a[0m[32m clear[0m[32m indic[0m[32mation[0m[32m for[0m[32m the[0m[32m driver[0m[32m to[0m[32m be[0m[32m more[0m[32m c[0m[32maut[0m[32mious[0m[32m while[0m[32m driving[0m[32m.[0m[32m The[0m[32m sign[0m[32m suggests[0m[32m that[0m[32m the[0m[32m driver[0m[32m should[0m[32m be[0m[32m more[0m[32m att[0m[32ment[0m[32mive[0m[32m and[0m[32m responsible[0m[32m while[0m[32m on[0m[32m the[0m[32m road[0m[32m.[0m[32m This[0m[32m is[0m[32m a[0m[32m cru[0m[32mcial[0m[32m aspect[0m[32m of[0m[32m safe[0m[32m driving[0m[32m,[0m[32m as[0m[32m it[0m[32m helps[0m[32m prevent[0m[32m acc[0m
16:08:12 | INFO | refresh rate:  0.26 FPS (3890.1 ms)
[32m1[0m[32m0[0m[32m0[0m[32m%[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m.[0m[32m The[0m[32m image[0m[32m features[0m[32m a[0m[32m clear[0m[32m indic[0m[32mation[0m[32m of[0m[32m a[0m[32m par[0m[32mking[0m[32m lot[0m[32m,[0m[32m which[0m[32m would[0m[32m likely[0m[32m guide[0m[32m a[0m[32m driver[0m[32m to[0m[32m park[0m[32m their[0m[32m vehicle[0m[32m in[0m[32m a[0m[32m designated[0m[32m area[0m[32m.[0m[32m The[0m[32m presence[0m[32m of[0m[32m a[0m[32m par[0m[32mking[0m[32m lot[0m[32m sign[0m[32m suggests[0m[32m that[0m[32m the[0m[32m driver[0m[32m should[0m[32m follow[0m[32m the[0m[32m rules[0m[32m and[0m[32m reg[0m[32mulations[0m[32m of[0m[32m the[0m[32m par[0m[32mking[0m[32m lot[0m[32m to[0m
16:08:16 | INFO | refresh rate:  0.28 FPS (3540.5 ms)
[32m1[0m[32m0[0m[32m0[0m[32m%[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m.[0m[32m The[0m[32m image[0m[32m features[0m[32m a[0m[32m clear[0m[32m indic[0m[32mation[0m[32m of[0m[32m a[0m[32m par[0m[32mking[0m[32m lot[0m[32m,[0m[32m which[0m[32m suggests[0m[32m that[0m[32m the[0m[32m driver[0m[32m should[0m[32m follow[0m[32m the[0m[32m rules[0m[32m and[0m[32m reg[0m[32mulations[0m[32m of[0m[32m the[0m[32m par[0m[32mking[0m[32m lot[0m[32m.[0m[32m The[0m[32m driver[0m[32m would[0m[32m likely[0m[32m park[0m[32m their[0m[32m vehicle[0m[32m in[0m[32m a[0m[32m designated[0m[32m area[0m[32m,[0m[32m as[0m[32m indicated[0m[32m by[0m[32m the[0m[32m sign[0m[32m.[0m[32m It[0m[32m is[0m[32m important[0m[32m for[0m
16:08:20 | INFO | refresh rate:  0.26 FPS (3920.7 ms)
[32m1[0m[32m0[0m[32m0[0m[32m%[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m.[0m[32m The[0m[32m image[0m[32m features[0m[32m a[0m[32m yellow[0m[32m and[0m[32m black[0m[32m "[0m[32mP[0m[32mark[0m[32ming[0m[32m"[0m[32m sign[0m[32m,[0m[32m which[0m[32m indicates[0m[32m that[0m[32m the[0m[32m driver[0m[32m should[0m[32m follow[0m[32m the[0m[32m rules[0m[32m and[0m[32m reg[0m[32mulations[0m[32m of[0m[32m the[0m[32m par[0m[32mking[0m[32m lot[0m[32m.[0m[32m The[0m[32m driver[0m[32m would[0m[32m likely[0m[32m park[0m[32m in[0m[32m designated[0m[32m areas[0m[32m and[0m[32m follow[0m[32m any[0m[32m specific[0m[32m par[0m[32mking[0m[32m reg[0m[32mulations[0m[32m,[0m[32m such[0m[32m as[0m[32m time[0m[32m limits[0m
16:08:24 | INFO | refresh rate:  0.25 FPS (3955.2 ms)
[32m1[0m[32m0[0m[32m0[0m[32m%[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m.[0m[32m The[0m[32m image[0m[32m features[0m[32m a[0m[32m "[0m[32mno[0m[32m par[0m[32mking[0m[32m"[0m[32m sign[0m[32m,[0m[32m which[0m[32m indicates[0m[32m that[0m[32m the[0m[32m driver[0m[32m should[0m[32m not[0m[32m park[0m[32m in[0m[32m that[0m[32m specific[0m[32m area[0m[32m.[0m[32m The[0m[32m driver[0m[32m would[0m[32m likely[0m[32m avoid[0m[32m par[0m[32mking[0m[32m in[0m[32m that[0m[32m location[0m[32m to[0m[32m avoid[0m[32m receiving[0m[32m a[0m[32m par[0m[32mking[0m[32m viol[0m[32mation[0m[32m or[0m[32m fine[0m[32m.[0m[32m[0m
16:08:27 | INFO | refresh rate:  0.27 FPS (3649.5 ms)
[32m1[0m[32m0[0m[32m0[0m[32m%[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m.[0m[32m The[0m[32m image[0m[32m features[0m[32m a[0m[32m "[0m[32mno[0m[32m par[0m[32mking[0m[32m"[0m[32m sign[0m[32m,[0m[32m which[0m[32m indicates[0m[32m that[0m[32m the[0m[32m driver[0m[32m should[0m[32m not[0m[32m park[0m[32m in[0m[32m that[0m[32m specific[0m[32m area[0m[32m.[0m[32m The[0m[32m driver[0m[32m would[0m[32m likely[0m[32m avoid[0m[32m par[0m[32mking[0m[32m in[0m[32m that[0m[32m location[0m[32m to[0m[32m avoid[0m[32m receiving[0m[32m a[0m[32m par[0m[32mking[0m[32m viol[0m[32mation[0m[32m or[0m[32m fine[0m[32m.[0m[32m[0m
16:08:31 | INFO | refresh rate:  0.29 FPS (3504.8 ms)
[32m1[0m[32m0[0m[32m0[0m[32m%[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m.[0m[32m The[0m[32m image[0m[32m features[0m[32m a[0m[32m "[0m[32mno[0m[32m par[0m[32mking[0m[32m"[0m[32m sign[0m[32m,[0m[32m which[0m[32m indicates[0m[32m that[0m[32m the[0m[32m driver[0m[32m should[0m[32m not[0m[32m park[0m[32m in[0m[32m that[0m[32m specific[0m[32m area[0m[32m.[0m[32m The[0m[32m driver[0m[32m would[0m[32m likely[0m[32m avoid[0m[32m par[0m[32mking[0m[32m in[0m[32m that[0m[32m location[0m[32m to[0m[32m avoid[0m[32m receiving[0m[32m a[0m[32m par[0m[32mking[0m[32m viol[0m[32mation[0m[32m or[0m[32m fine[0m[32m.[0m[32m[0m
16:08:35 | INFO | refresh rate:  0.28 FPS (3512.4 ms)
[32m1[0m[32m0[0m[32m0[0m[32m%[0m[32m
[0m[32m
[0m[32mIn[0m[32m the[0m[32m image[0m[32m,[0m[32m there[0m[32m is[0m[32m a[0m[32m yellow[0m[32m and[0m[32m black[0m[32m traffic[0m[32m sign[0m[32m with[0m[32m an[0m[32m arrow[0m[32m pointing[0m[32m up[0m[32mwards[0m[32m.[0m[32m The[0m[32m sign[0m[32m is[0m[32m clearly[0m[32m visible[0m[32m and[0m[32m is[0m[32m placed[0m[32m on[0m[32m a[0m[32m wooden[0m[32m door[0m[32m.[0m[32m A[0m[32m driver[0m[32m,[0m[32m upon[0m[32m seeing[0m[32m this[0m[32m sign[0m[32m,[0m[32m would[0m[32m likely[0m[32m be[0m[32m aware[0m[32m of[0m[32m the[0m[32m up[0m[32mward[0m[32m direction[0m[32m of[0m[32m the[0m[32m road[0m[32m or[0m[32m the[0m[32m entrance[0m[32m to[0m[32m a[0m
16:08:38 | INFO | refresh rate:  0.26 FPS (3917.2 ms)
[32m1[0m[32m0[0m[32m0[0m[32m%[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m.[0m[32m The[0m[32m image[0m[32m features[0m[32m a[0m[32m yellow[0m[32m and[0m[32m black[0m[32m traffic[0m[32m sign[0m[32m,[0m[32m which[0m[32m is[0m[32m likely[0m[32m to[0m[32m be[0m[32m a[0m[32m "[0m[32my[0m[32mield[0m[32m"[0m[32m or[0m[32m "[0m[32mstop[0m[32m"[0m[32m sign[0m[32m.[0m[32m A[0m[32m driver[0m[32m would[0m[32m need[0m[32m to[0m[32m pay[0m[32m close[0m[32m attention[0m[32m to[0m[32m the[0m[32m sign[0m[32m and[0m[32m follow[0m[32m the[0m[32m appropriate[0m[32m action[0m[32m,[0m[32m which[0m[32m could[0m[32m be[0m[32m either[0m[32m yield[0m[32ming[0m[32m to[0m[32m the[0m[32m on[0m[32mcoming[0m
16:08:43 | INFO | refresh rate:  0.23 FPS (4299.5 ms)
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/opt/NanoLLM/nano_llm/agents/video_query.py", line 357, in <module>
    agent = VideoQuery(**vars(args)).run() 
  File "/opt/NanoLLM/nano_llm/agent.py", line 58, in run
    self.pipeline[0].join(timeout)
  File "/usr/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt
[32m1[0m[32m0[0m[32m0[0m[32m%[0m[32m confidence[0m[32m score[0m[32m for[0m[32m the[0m[32m image[0m[32m.[0m[32m The[0mException ignored in: <module 'threading' from '/usr/lib/python3.10/threading.py'>
Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1567, in _shutdown
    lock.acquire()
KeyboardInterrupt: 
